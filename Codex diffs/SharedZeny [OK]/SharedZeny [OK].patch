diff --git a/src/char/char.cpp b/src/char/char.cpp
index 28f2080238da4576956001f7907bc98253702f2f..2b942167e478005464a6de8fd42da47215f18ccc 100644
--- a/src/char/char.cpp
+++ b/src/char/char.cpp
@@ -85,6 +85,55 @@ std::unordered_map<uint32, std::shared_ptr<struct auth_node>>& char_get_authdb()
 std::unordered_map<uint32, std::shared_ptr<struct online_char_data>>& char_get_onlinedb() { return online_char_db; }
 std::unordered_map<uint32, std::shared_ptr<struct mmo_charstatus>>& char_get_chardb() { return char_db; }
 
+
+static bool bg_stats_schema_ready = false;
+
+bool char_bg_stats_schema_ready() {
+	return bg_stats_schema_ready;
+}
+
+static bool char_bg_schema_has_column(const char* table_name, const char* column_name) {
+	if (SQL_ERROR == Sql_Query(sql_handle,
+		"SELECT 1 FROM `information_schema`.`COLUMNS` WHERE `TABLE_SCHEMA` = DATABASE() AND `TABLE_NAME` = '%s' AND `COLUMN_NAME` = '%s' LIMIT 1",
+		table_name, column_name)) {
+		Sql_ShowDebug(sql_handle);
+		return false;
+	}
+
+	return SQL_SUCCESS == Sql_NextRow(sql_handle);
+}
+
+static void char_bg_stats_detect_schema() {
+	static const char* required_columns[][2] = {
+		{"char_bg", "char_id"},
+		{"char_bg", "win"},
+		{"char_bg", "lost"},
+		{"char_bg", "tie"},
+		{"char_bg", "deserter"},
+		{"char_bg", "score"},
+		{"char_bg", "points"},
+		{"char_bg", "rank_points"},
+		{"char_bg", "rank_games"},
+		{"char_wstats", "char_id"},
+		{"char_wstats", "score"},
+		{"char_wstats", "points"},
+	};
+
+	bg_stats_schema_ready = true;
+
+	for (const auto& requirement : required_columns) {
+		if (!char_bg_schema_has_column(requirement[0], requirement[1])) {
+			bg_stats_schema_ready = false;
+			ShowWarning("Extended BG rev24 stats persistence disabled: missing `%s`.`%s` column.\n", requirement[0], requirement[1]);
+			break;
+		}
+	}
+
+	if (bg_stats_schema_ready)
+		ShowStatus("Extended BG rev24 stats schema detected (char_bg/char_wstats).\n");
+}
+
+
 online_char_data::online_char_data( uint32 account_id ){
 	this->account_id = account_id;
 	this->char_id = -1;
@@ -303,7 +352,7 @@ int32 char_mmo_char_tosql(uint32 char_id, struct mmo_charstatus* p){
 	)
 	{	//Save status
 		if( SQL_ERROR == Sql_Query(sql_handle, "UPDATE `%s` SET `base_level`='%d', `job_level`='%d',"
-			"`base_exp`='%" PRIu64 "', `job_exp`='%" PRIu64 "', `zeny`='%d',"
+			"`base_exp`='%" PRIu64 "', `job_exp`='%" PRIu64 "',"
 			"`max_hp`='%u',`hp`='%u',`max_sp`='%u',`sp`='%u',`status_point`='%d',`skill_point`='%d',"
 			"`str`='%d',`agi`='%d',`vit`='%d',`int`='%d',`dex`='%d',`luk`='%d',"
 			"`option`='%d',`party_id`='%d',`guild_id`='%d',`pet_id`='%d',`homun_id`='%d',`elemental_id`='%d',"
@@ -316,7 +365,7 @@ int32 char_mmo_char_tosql(uint32 char_id, struct mmo_charstatus* p){
 			"`pow`='%d',`sta`='%d',`wis`='%d',`spl`='%d',`con`='%d',`crt`='%d'"
 			" WHERE `account_id`='%d' AND `char_id` = '%d'",
 			schema_config.char_db, p->base_level, p->job_level,
-			p->base_exp, p->job_exp, p->zeny,
+			p->base_exp, p->job_exp,
 			p->max_hp, p->hp, p->max_sp, p->sp, p->status_point, p->skill_point,
 			p->str, p->agi, p->vit, p->int_, p->dex, p->luk,
 			p->option, p->party_id, p->guild_id, p->pet_id, p->hom_id, p->ele_id,
@@ -519,6 +568,26 @@ int32 char_mmo_char_tosql(uint32 char_id, struct mmo_charstatus* p){
 	}
 #endif
 
+	if( p->zeny != cp->zeny ){
+		bool tx_started = false;
+		if( SQL_ERROR != Sql_Query(sql_handle, "START TRANSACTION") ){
+			tx_started = true;
+		}
+
+		if( SQL_ERROR == Sql_Query(sql_handle, "UPDATE `login` SET `zeny`='%d' WHERE `account_id` = '%d'", p->zeny, p->account_id) ){
+			Sql_ShowDebug(sql_handle);
+			errors++;
+			if( tx_started )
+				Sql_Query(sql_handle, "ROLLBACK");
+		}else if( tx_started && SQL_ERROR == Sql_Query(sql_handle, "COMMIT") ){
+			Sql_ShowDebug(sql_handle);
+			errors++;
+			Sql_Query(sql_handle, "ROLLBACK");
+		}else{
+			strcat(save_status, " zeny");
+		}
+	}
+
 	if (save_status[0]!='\0' && charserv_config.save_log)
 		ShowInfo("Saved char %d - %s:%s.\n", char_id, p->name, save_status);
 
@@ -920,6 +989,19 @@ int32 char_mmo_chars_fromsql( char_session_data& sd, CHARACTER_INFO chars[], uin
 		sd.unban_time[i] = 0;
 	}
 
+
+	int32 shared_zeny = 0;
+	if( SQL_ERROR == Sql_Query(sql_handle, "SELECT `zeny` FROM `login` WHERE `account_id`='%d'", sd.account_id) ) {
+		Sql_ShowDebug(sql_handle);
+		return 0;
+	}
+	if( SQL_SUCCESS == Sql_NextRow(sql_handle) ){
+		char* data = nullptr;
+		Sql_GetData(sql_handle, 0, &data, nullptr);
+		shared_zeny = data != nullptr ? atoi(data) : 0;
+	}
+	Sql_FreeResult(sql_handle);
+
 	// read char data
 	if( SQL_ERROR == stmt.Prepare( "SELECT "
 		"`char_id`,`char_num`,`name`,`class`,`base_level`,`job_level`,`base_exp`,`job_exp`,`zeny`,"
@@ -1003,6 +1085,7 @@ int32 char_mmo_chars_fromsql( char_session_data& sd, CHARACTER_INFO chars[], uin
 		sd.found_char[p.slot] = p.char_id;
 		sd.unban_time[p.slot] = p.unban_time;
 		p.sex = char_mmo_gender( &sd, &p, sex[0] );
+		p.zeny = shared_zeny;
 		j += char_mmo_char_tobuf( chars[i], p );
 
 		// Addon System
@@ -1038,6 +1121,7 @@ int32 char_mmo_char_fromsql(uint32 char_id, struct mmo_charstatus* p, bool load_
 
 	if (charserv_config.save_log) ShowInfo("Char load request (%d)\n", char_id);
 
+
 	// read char data
 	if( SQL_ERROR == stmt.Prepare( "SELECT "
 		"`char_id`,`account_id`,`char_num`,`name`,`class`,`base_level`,`job_level`,`base_exp`,`job_exp`,`zeny`,"
@@ -1141,9 +1225,20 @@ int32 char_mmo_char_fromsql(uint32 char_id, struct mmo_charstatus* p, bool load_
 	}
 	p->sex = char_mmo_gender(nullptr, p, sex[0]);
 
-	StringBuf_Init(&msg_buf);
+StringBuf_Init(&msg_buf);
 	StringBuf_AppendStr(&msg_buf, " status");
 
+	if( SQL_ERROR == Sql_Query(sql_handle, "SELECT `zeny` FROM `login` WHERE `account_id`='%d'", p->account_id) ){
+		Sql_ShowDebug(sql_handle);
+		return 0;
+	}
+	if( SQL_SUCCESS == Sql_NextRow(sql_handle) ){
+		char* data = nullptr;
+		Sql_GetData(sql_handle, 0, &data, nullptr);
+		p->zeny = data != nullptr ? atoi(data) : 0;
+	}
+	Sql_FreeResult(sql_handle);
+
 	if (!load_everything) // For quick selection of data when displaying the char menu
 	{
 		return 1;
@@ -1500,15 +1595,21 @@ int32 char_make_new_char( struct char_session_data* sd, char* name_, int32 str,
 	}
 #endif
 
+	if( SQL_ERROR == Sql_Query(sql_handle, "START TRANSACTION") ) {
+		Sql_ShowDebug(sql_handle);
+		return -2;
+	}
+
 	//Insert the new char entry to the database
 	if( SQL_ERROR == Sql_Query(sql_handle, "INSERT INTO `%s` (`account_id`, `char_num`, `name`, `class`, `zeny`, `status_point`, `str`, `agi`, `vit`, `int`, `dex`, `luk`, `max_hp`, `hp`,"
 		"`max_sp`, `sp`, `hair`, `hair_color`, `last_map`, `last_x`, `last_y`, `save_map`, `save_x`, `save_y`, `sex`, `last_instanceid`, `body`) VALUES ("
-		"'%d', '%d', '%s', '%d', '%d',  '%d', '%d', '%d', '%d', '%d', '%d', '%d', '%u', '%u', '%u', '%u', '%d', '%d', '%s', '%d', '%d', '%s', '%d', '%d', '%c', '0', '%d')",
-		schema_config.char_db, sd->account_id , slot, esc_name, start_job, charserv_config.start_zeny, status_points, str, agi, vit, int_, dex, luk,
+		"'%d', '%d', '%s', '%d', '0',  '%d', '%d', '%d', '%d', '%d', '%d', '%d', '%u', '%u', '%u', '%u', '%d', '%d', '%s', '%d', '%d', '%s', '%d', '%d', '%c', '0', '%d')",
+		schema_config.char_db, sd->account_id , slot, esc_name, start_job, status_points, str, agi, vit, int_, dex, luk,
 		(40 * (100 + vit)/100) , (40 * (100 + vit)/100 ),  (11 * (100 + int_)/100), (11 * (100 + int_)/100), hair_style, hair_color,
 		tmp_start_point[start_point_idx].map, tmp_start_point[start_point_idx].x, tmp_start_point[start_point_idx].y, tmp_start_point[start_point_idx].map, tmp_start_point[start_point_idx].x, tmp_start_point[start_point_idx].y, sex, start_job ) )
 	{
 		Sql_ShowDebug(sql_handle);
+		Sql_Query(sql_handle, "ROLLBACK");
 		return -2; //No, stop the procedure!
 	}
 
@@ -1520,6 +1621,18 @@ int32 char_make_new_char( struct char_session_data* sd, char* name_, int32 str,
 			Sql_ShowDebug(sql_handle);
 	}
 
+	if( SQL_ERROR == Sql_Query(sql_handle, "UPDATE `login` SET `zeny`=`zeny` + '%d' WHERE `account_id` = '%d'", charserv_config.start_zeny, sd->account_id) ) {
+		Sql_ShowDebug(sql_handle);
+		Sql_Query(sql_handle, "ROLLBACK");
+		return -2;
+	}
+
+	if( SQL_ERROR == Sql_Query(sql_handle, "COMMIT") ) {
+		Sql_ShowDebug(sql_handle);
+		Sql_Query(sql_handle, "ROLLBACK");
+		return -2;
+	}
+
 	ShowInfo("Created char: account: %d, char: %d, slot: %d, name: %s\n", sd->account_id, char_id, slot, name);
 	return char_id;
 }
@@ -3255,6 +3368,7 @@ bool CharacterServer::initialize( int32 argc, char *argv[] ){
 		ShowFatalError("char : A tables is missing in sql-server, please fix it, see (sql-files main.sql for structure) \n");
 		return false;
 	}
+	char_bg_stats_detect_schema();
 	//Cleaning the tables for nullptr entrys @ startup [Sirius]
 	//Chardb clean
 	if( SQL_ERROR == Sql_Query(sql_handle, "DELETE FROM `%s` WHERE `account_id` = '0'", schema_config.char_db) )
@@ -3268,6 +3382,18 @@ bool CharacterServer::initialize( int32 argc, char *argv[] ){
 	if( SQL_ERROR == Sql_Query(sql_handle, "DELETE FROM `%s` WHERE `guild_id` = '0' AND `char_id` = '0'", schema_config.guild_member_db) )
 		Sql_ShowDebug(sql_handle);
 
+	if (SQL_SUCCESS != Sql_Query(sql_handle, "SHOW COLUMNS FROM `login` LIKE 'zeny'")) {
+		Sql_ShowDebug(sql_handle);
+		return false;
+	}
+	if (Sql_NumRows(sql_handle) == 0) {
+		if (SQL_SUCCESS != Sql_Query(sql_handle, "ALTER TABLE `login` ADD `zeny` INT(11) UNSIGNED NOT NULL DEFAULT '0'")) {
+			Sql_ShowDebug(sql_handle);
+			return false;
+		}
+	}
+	Sql_FreeResult(sql_handle);
+
 	set_defaultparse(chclif_parse);
 
 	if( (char_fd = make_listen_bind(charserv_config.bind_ip,charserv_config.char_port)) == -1 ) {
